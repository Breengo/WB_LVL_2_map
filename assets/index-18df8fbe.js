(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))d(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&d(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function d(n){if(n.ep)return;n.ep=!0;const c=o(n);fetch(n.href,c)}})();const e=[],a=L.map("map").setView([-19.505,47.09],6);L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(a);const l=document.querySelector("#markerOptions"),g=()=>{document.querySelector("#markerOptions").innerHTML=`
  <h2>Параметры маркера</h2>
  <input placeholder="Тип" type="text" />
  <input placeholder="Название" type="text" />
  <textarea placeholder="Описание" cols="30" rows="10"></textarea>
  <button id="colorBtn">Поменять цвет</button>
  <button id="saveBtn">Сохранить</button>
  <button id="deleteBtn">Удалить</button>`},v=t=>{t.on("dragend",r=>{u()}),t.on("click",r=>{const o=e.indexOf(t);g();const d=l.querySelector("#saveBtn"),n=l.querySelector("#deleteBtn"),c=l.querySelector("#colorBtn"),i=l.querySelectorAll("input"),p=l.querySelector("textarea");let s=e[o].color;l.style.display="flex",i[0].value=e[o].type,i[1].value=e[o].options.title,p.value=e[o].description,c.addEventListener("click",()=>{t._icon.classList.remove(`color${s}`),s<6?s++:s=1,t._icon.classList.add(`color${s}`)}),d.addEventListener("click",()=>{e[o]&&(e[o].type=i[0].value,e[o].options.title=i[1].value,e[o].description=p.value,e[o].color=s,i.forEach(y=>y.value=""),p.value="",l.style.display="none",u())}),n.addEventListener("click",()=>{a.removeLayer(t),e.splice(o,1),u()})})},f=localStorage.getItem("markers");if(f){const t=JSON.parse(f);setTimeout(()=>{t.forEach(r=>{const o=L.marker(r.latlng,{draggable:!0,title:`${r.title}`}).addTo(a);o._icon.classList.add(`color${r.color}`),e.push(o),e[e.length-1].description=r.description,e[e.length-1].type=r.type,e[e.length-1].color=r.color,v(o)})},0)}const u=()=>{localStorage.setItem("markers",JSON.stringify(e.map(t=>({latlng:t._latlng,title:t.options.title,description:t.description,type:t.type,color:t.color}))))},m=()=>{e.forEach(t=>{t.description.toLowerCase().includes(h.value.toLowerCase())?t.setOpacity(1):t.setOpacity(0)})},h=document.querySelector("#search");h.addEventListener("input",m);e.forEach(t=>{L.marker(t.latlng,{draggable:!0,title:`${t.options.title}`}).addTo(a)});a.on("contextmenu",t=>{let r=0;const o=L.marker(t.latlng,{draggable:!0,title:"Marker"}).addTo(a);g();const d=l.querySelector("#saveBtn"),n=l.querySelector("#deleteBtn"),c=l.querySelector("#colorBtn"),i=l.querySelectorAll("input"),p=l.querySelector("textarea");e.push(o);const s=e.length-1;l.style.display="flex",e[s].color=r,c.addEventListener("click",()=>{o._icon.classList.remove(`color${r}`),r<6?r++:r=1,o._icon.classList.add(`color${r}`)}),d.addEventListener("click",()=>{e[s]&&(e[s].type=i[0].value,e[s].options.title=i[1].value,e[s].description=p.value,e[s].color=r,i.forEach(y=>y.value=""),p.value="",l.style.display="none",u())}),n.addEventListener("click",()=>{a.removeLayer(o),e.splice(s,1),u()}),o.on("dragend",y=>{u()}),v(o)});
